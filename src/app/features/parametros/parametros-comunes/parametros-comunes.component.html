<h1>Parámetros Comunes</h1>

<button pButton type="button" class="ml-2" (click)="crearNuevoParametroComun()"
        label="Nuevo Parametro Común"></button>


<section class="busquedas-filtro">
  <!-- FORMULARIO BUSQUEDA SIMPLE -->
  <div class="card flex justify-content-center align-content-center text-center">
    <div class="busqueda-simple" *ngIf="busquedaSimple">
      <h4>Busqueda simple</h4>
      <form [formGroup]="formularioBusquedaSimple" class="formgroup-inline">

        <div class="field">
          <select class="w-full text-color surface-overlay"
                  formControlName="selectedIndice" (change)="cambiarCampoDeBusqueda()">
            <option *ngFor="let option of opcionesBusqueda" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>
        <!-- CODIGO, NOMBRE, DESCRIPCION, PRESICIÓN  -->
        <div *ngIf="campoBusqueda <=3 || campoBusqueda === 10 " class="field">
          <input class="inputfield w-full" type="text" pInputText
                 formControlName="campoBuscar" autocomplete="off">
        </div>

        <!-- GRUPO -->
        <div *ngIf="campoBusqueda === 4" class="field">
          <select class="w-full  text-color surface-overlay"
                  style="appearance: auto" formControlName="campoBuscar">
            <option *ngFor="let option of grupoOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>

        <!-- TIPO VALIDACIÓN-->
        <div *ngIf="campoBusqueda === 5" class="field">
          <select class="w-full  text-color surface-overlay"
                  style="appearance: auto" formControlName="campoBuscar">
            <option *ngFor="let option of tipoValidacionOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>

        <!--MULTIVALUADO-->

        <div *ngIf="campoBusqueda === 6" class="field">
          <select class="w-full  text-color surface-overlay"
                  style="appearance: auto" formControlName="campoBuscar">
            <option *ngFor="let option of multivaluadoOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>

        <!--TIPO DATO -->

        <div *ngIf="campoBusqueda === 7" class="field">
          <select class="w-full  text-color surface-overlay"
                  style="appearance: auto" formControlName="campoBuscar">
            <option *ngFor="let option of tipoDatoOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>

        <!--LONGITUD -->
        <div *ngIf="campoBusqueda === 8" class="field">
          <input class="inputfield w-full" type="text" pInputText
                 formControlName="campoBuscar" autocomplete="off">
        </div>


        <!-- UNIDAD  -->
        <div *ngIf="campoBusqueda === 9" class="field">
          <select class="w-full  text-color surface-overlay"
                  style="appearance: auto" formControlName="campoBuscar">
            <option *ngFor="let option of unidadOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>


        <button pButton type="submit" icon="pi pi-search" iconPos="right" label="Ir"
                (click)="buscarPorFiltroSimple()"></button>

        <button pButton type="button" class="ml-2" id="btnBusquedaAvanzada" (click)="cambiarBusqueda(false)"
                label="Busqueda Avanzada"></button>

      </form>

    </div>

    <!-- FORMULARIO BUSQUEDA SIMPLE -->


    <!-- FORMULARIO BUSQUEDA AVANZADA -->
    <div class="busqueda-avanzada" *ngIf="!busquedaSimple">

      <br>

      <div class="acciones-busqueda-avanzada mb-3">

        <h4>Busqueda Avanzada</h4>

        <button pButton type="button" id="btnBusquedaSimple" icon="pi pi-arrow-circle-left" iconPos="left"
                class="mr-1" (click)="cambiarBusqueda(true)" label="Volver a Busqueda simple"></button>

        <button pButton type="button" icon="pi pi-search" iconPos="right" class="mr-1" label="Buscar"
                (click)="buscarPorFiltroAvanzado()"></button>

        <button pButton type="button" icon="pi pi-times-circle" iconPos="right" class="" label="Limpiar"
                (click)="limpiarCamposFormularioBusquedaAvanzada()"></button>


      </div>


      <form [formGroup]="formularioBusquedaAvanzada" class="formgrid">

        <div class="card">
          <div class="formgrid">

            <div class="grid justify-content-center">
              <div class="field col-3">
                <label for="codigo">Código</label>

                <input id="codigo" class="inputfield w-full" type="text"
                       pInputText autocomplete="off" name="codigo" formControlName="codigo">
              </div>

              <div class="field col-3">
                <label for="codigo">Nombre</label>

                <input id="nombre" class="inputfield w-full" type="text"
                       pInputText autocomplete="off" name="nombre" formControlName="nombre">
              </div>

              <div class="field col-3">
                <label for="descripcion">Descripción</label>

                <input id="descripcion" class="inputfield w-full" type="text"
                       pInputText autocomplete="off" name="descripcion" formControlName="descripcion">
              </div>

              <div class="field col-3">
                <label for="grupo">Grupo</label>

                <select class="w-full  text-color surface-overlay" name="grupo" id="grupo" style="appearance: auto"
                        formControlName="grupo">
                  <option *ngFor="let option of grupoOpciones" value="{{option.value}}">{{option.label}} </option>
                </select>
              </div>


            </div>

            <div class="grid justify-content-center">

              <div class="field col-2">
                <label for="tipoValidacion">Tipo Validación</label>

                <select class="w-full  text-color surface-overlay" name="tipoValidacion" id="tipoValidacion" style="appearance: auto"
                        formControlName="tipoValidacion">
                  <option *ngFor="let option of tipoValidacionOpciones" value="{{option.value}}">{{option.label}} </option>
                </select>
              </div>

              <div class="field col-2">
                <label for="multivaluado">¿Multivaluado?</label>
                <select class="w-full  text-color surface-overlay" name="multivaluado" id="multivaluado"
                        style="appearance: auto" formControlName="multivaluado">
                  <option *ngFor="let option of multivaluadoOpciones" value="{{option.value}}">{{option.label}} </option>
                </select>
              </div>

              <div class="field col-2">
                <label for="tipoDato">Tipo Dato</label>
                <select class="w-full  text-color surface-overlay" name="tipoDato" id="tipoDato"
                        style="appearance: auto" formControlName="tipoDato">
                  <option *ngFor="let option of tipoDatoOpciones" value="{{option.value}}">{{option.label}}</option>
                </select>
              </div>

              <div class="field col-2">
                <label for="longitud">Longitud</label>
                <input id="longitud" class="inputfield w-full" type="text"
                       pInputText autocomplete="off" name="longitud" formControlName="longitud">
              </div>

              <div class="field col-2">
                <label for="unidad">Unidad</label>
                <select class="w-full  text-color surface-overlay" name="unidad" id="unidad"
                        style="appearance: auto" formControlName="unidad">
                  <option *ngFor="let option of unidadOpciones" value="{{option.value}}">{{option.label}} </option>
                </select>
              </div>

              <div class="field col-2">
                <label for="precision">Precisión</label>
                <input id="precision" class="inputfield w-full" type="text"
                       pInputText autocomplete="off" name="precision" formControlName="precision">
              </div>

            </div>
          </div>
        </div>

      </form>

    </div>
    <!-- FORMULARIO BUSQUEDA AVANZADA -->

  </div>
</section>


<!--TABLA PARAMETROS COMUNES -->

<section class="tabulacion-parametros-comunes">
  <div class="parametros-especificos">

    <button pButton type="button" class="ml-2" id="detalles" (click)="mostrarDialogDetallesParamatero()"
            label="Detalles"></button>

    <p-table
      #turboTable
      paginatorPosition="top"
      [scrollable]="true"
      [rows]="10"
      [showCurrentPageReport]="true"
      selectionMode="single"
      [paginator]="true"
      [(selection)]="parametroComunSeleccionado"
      (onRowUnselect)="deSeleccionarFila()"
      [metaKeySelection]="false"
      dataKey="codigo"
      scrollDirection="both"
      [value]=" this.parametrosComunesResponse.content"
      [totalRecords]=" this.parametrosComunesResponse.totalElements "
      [lazy]="true"
      (onLazyLoad)="cambiarPageParametrosComunes($event)"
      styleClass="p-datatable-gridlines"
      [(first)]="firsParamComunes"
      currentPageReportTemplate="Mostrando {{offSetParametrosComunesGeneral}}  a {last} de {{  this.parametrosComunesResponse.totalElements }} registros ">
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 4vw">Código</th>
          <th style="width: 10vw">Nombre</th>
          <th style="width: 25vw">Descripción</th>
          <th style="width: 6vw">Grupo</th>
          <th style="width: 5vw">Tipo Validación</th>
          <th style="width: 6vw">¿Multivaluado?</th>
          <th style="width: 7vw">Tipo Dato</th>
          <th style="width: 6vw">Longitud</th>
          <th style="width: 8vw">Unidad</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-parametroComun>
        <tr class="text-left" [pSelectableRow]="parametroComun" (dblclick)="seleccionarFilaParamComunes(parametroComun)">
          <td style="width: 4vw"> {{ parametroComun.codigo }}  </td>
          <td style="width: 10vw"> {{ parametroComun.nombre }}  </td>
          <td style="width: 25vw"> {{ parametroComun.descripcion }}   </td>
          <td style="width: 6vw"> {{ parametroComun.grupo }}  </td>
          <td style="width: 5vw"> {{ parametroComun.tipoValidacion }}  </td>
          <td style="width: 6vw"> {{ parametroComun.multivaluado}} </td>
          <td style="width: 7vw"> {{ parametroComun.tipoDato}}</td>
          <td style="width: 6vw"> {{ parametroComun.longitud}}</td>
          <td style="width: 8vw"> {{ parametroComun.unidad}}</td>
        </tr>
      </ng-template>
    </p-table>

  </div>

</section>


<!-- DIALOG DETALLES PARAMETRO COMUN SELECCIONADO -->

<p-dialog [(visible)]="mostrarDialogDetalles"
          [modal]="true"
          [style]="{width: '80%'}"
          [baseZIndex]="10000"
          [draggable]="false"
          [dismissableMask]="true">

  <ng-template pTemplate="header">
    <h2> Editar Parametro Común {{ parametroComunSeleccionado.descripcion }}  </h2>
  </ng-template>
  <div class="card">


    <form class="formgrid" [formGroup]="formularioParametrosComunes">
      <button pButton type="button" (click)="editarOcrearParametroComun()" label="Grabar"></button>

      <p-paginator #paginador
                   [rows]="1"
                   [totalRecords]="this.parametrosComunesResponse.totalElements"
                   currentPageReportTemplate="{first} de {{ this.parametrosComunesResponse.totalElements }}"
                   [showCurrentPageReport]="true"
                   [pageLinkSize]="1"
                   (onPageChange)="cambiarPageParametroComunSeleccionado($event)">
      </p-paginator>


      <div class="field grid mb-2 ">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Código</label>
        <div class="col-12 md:col-3">
          <span class="text-sm">{{  parametroComunSeleccionado.codigo }}</span>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Nombre</label>
        <div class="col-12 md:col-9">
          <span class="text-sm" style="width: 20rem !important;"> {{  parametroComunSeleccionado.nombre }}  </span>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem ">* Descripción</label>
        <div class="col-12 md:col-3">
          <input id="descripcion" class="inputfield w-full" type="text"
                 pInputText autocomplete="off" name="descripcion" formControlName="descripcion"
                 style="appearance: auto; height: 20px !important; width: 30rem !important;">
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">* Grupo</label>
        <div class="col-12 md:col-3">
          <select class="w-full  text-color surface-overlay" formControlName="grupo"
                  style="appearance: auto; height: 20px !important;" required>
            <option *ngFor="let option of grupoOpciones" value="{{option.value}}">
              {{option.label}}
            </option>
          </select>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">* Tipo Validación</label>
        <div class="col-12 md:col-3">
          <select class="w-full  text-color surface-overlay" name="tipoValidacion" formControlName="tipoValidacion"
                  style="appearance: auto; height: 20px !important;" required>
            <option *ngFor="let option of tipoValidacionOpciones" value="{{option.value}}">
              {{option.label}}
            </option>
          </select>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">¿Multivaluado?</label>
        <div class="col-12 md:col-3">
          <span class="text-sm">  {{ parametroComunSeleccionado.multivaluado }} </span>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Tipo Dato</label>
        <div class="col-12 md:col-3">
          <select class="w-full  text-color surface-overlay" name="tipoDato" formControlName="tipoDato"
                  id="tipoDato" style="appearance: auto; height: 20px !important;" required>
            <option *ngFor="let option of tipoDatoOpciones" value="{{option.value}}">{{option.label}} </option>
          </select>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Longitud</label>
        <div class="col-12 md:col-3">
          <span class="text-sm"> {{ parametroComunSeleccionado.longitud  }}  </span>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Unidad</label>
        <div class="col-12 md:col-3">
          <span class="text-sm"> {{ parametroComunSeleccionado.unidad }}  </span>
        </div>
      </div>

      <div class="field grid mb-2">
        <label class="col-12 mb-2 md:col-2 md:mb-0" style="background: #EEE;  width: 15rem; ">Precisión</label>
        <div class="col-12 md:col-3">
          <span class="text-sm">  {{ parametroComunSeleccionado.precision }}   </span>
        </div>
      </div>

    </form>

    <button pButton type="button" class="ml-2" (click)="crearNuevoParametroComun()"
            label="Nuevo Parametro Común"></button>


    <h4>Valores Parámetro</h4>

    <p-table
      [rows]="10"
      [paginator]="true"
      [showCurrentPageReport]="true"
      [value]="this.parametroComunSeleccionado.valoresParametros.content"
      [totalRecords]="this.parametroComunSeleccionado.valoresParametros.totalElements"
      paginatorPosition="top"
      selectionMode="single"
      [(selection)]="valorParametroSeleccionado"
      (onRowUnselect)="deSeleccionarFilarValoresParametro()"
      [lazy]="true"
      (onLazyLoad)="cambiarPageValoresParametro($event)"
      [pageLinks]="1"
      currentPageReportTemplate="Mostrando {first} de {{  this.parametroComunSeleccionado.valoresParametros.totalElements }} registros "

      styleClass="p-datatable-sm p-datatable-gridlines" class="text-base">
      <ng-template pTemplate="header">
        <tr>
          <button pButton type="button" class="ml-2" (click)="mostrarDetalleValoresParametro()"
                  label="Detalles" [disabled]="this.parametroComunSeleccionado.valoresParametros.content.length <= 0 ">
          </button>
        </tr>
        <tr>
          <th>Descripción</th>
          <th>Valor</th>
          <th>Fecha Vigencia</th>
          <th>Valor Máximo</th>
          <th>Fecha Fin de Vigencia</th>
          <th>Estado</th>
          <th>Fecha Estado</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-valorParametro>
        <tr [pSelectableRow]="valorParametro" (dblclick)="seleccionarFilaValoresParametro(valorParametro)">
          <td> {{ valorParametro.descripcion }}</td>
          <td> {{ valorParametro.valor }} </td>
          <td> {{ valorParametro.fechaVigencia }} </td>
          <td> {{ valorParametro.valorMaximo }} </td>
          <td> {{ valorParametro.fechaFinVigencia }}</td>
          <td> {{ valorParametro.estado }}</td>
          <td> {{ valorParametro.fechaEstado}}</td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7">No hay registros disponibles</td>
        </tr>
      </ng-template>

    </p-table>

    <button pButton type="button" class="ml-2 mt-1"
            [disabled]="this.parametroComunSeleccionado.multivaluado.toUpperCase() === 'NO'
         && this.parametroComunSeleccionado.valoresParametros.content.length > 0"

            label="Nuevo Valor Parámetro"
            (click)="agregarNuevoValorParametro()"></button>

  </div>


  <ng-template pTemplate="footer">
    <p class="campos-obligatorios text-left">Los campos marcados con asterisco (*) son obligatorios</p>
    <hr>
  </ng-template>


</p-dialog>


<!-- DIALOG DE UN NUEVO PARAMETRO COMUN-->

<p-dialog [(visible)]="mostrarDialogNuevoParametroComun"
          [modal]="true"
          [style]="{width: '90%'}"
          [baseZIndex]="10000"
          [draggable]="false"
          [dismissableMask]="true">

  <ng-template pTemplate="header">
    <h2> Ingrese Nuevo Parámetro Común </h2>
  </ng-template>


  <form [formGroup]="formularioNuevoParametroComun" class="formgrid">

    <button pButton type="button" id="btnGuardar" (click)="grabarParametroComun()" label="Grabar"></button>

    <div class="card mt-2">
      <div class="formgrid">

        <div class="grid justify-content-center">
          <div class="field col-3">
            <label for="codigo"> * Código</label>

            <input id="codigo" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="codigo" [maxlength]="4"
                   restriccionInputRegex
                   [regex]="ValidacionRegexEnum.ALFANUMERICO_SIN_ESPACIO"
                   formControlName="codigo">
          </div>

          <div class="field col-3">
            <label for="codigo"> * Nombre</label>

            <input id="nombre" class="inputfield w-full" type="text" [maxlength]="50"
                   restriccionInputRegex
                   [regex]="ValidacionRegexEnum.ALFANUMERICO"
                   pInputText autocomplete="off" name="nombre" formControlName="nombre">
          </div>

          <div class="field col-3">
            <label for="descripcion"> * Descripción</label>

            <input id="descripcion" class="inputfield w-full" type="text" [maxlength]="300"
                   restriccionInputRegex
                   [regex]="ValidacionRegexEnum.ALFANUMERICO"
                   pInputText autocomplete="off" name="descripcion" formControlName="descripcion">
          </div>

          <div class="field col-3">
            <label for="grupo">* Grupo</label>

            <select class="w-full  text-color surface-overlay" name="grupo" id="grupo" style="appearance: auto"
                    formControlName="grupo">
              <option *ngFor="let option of grupoOpciones" value="{{option.value}}">{{option.label}} </option>
            </select>
          </div>


        </div>

        <div class="grid justify-content-center">

          <div class="field col-2">
            <label for="tipoValidacion">* Tipo Validación</label>

            <select class="w-full  text-color surface-overlay" name="tipoValidacion" formControlName="tipoValidacion"
                    id="tipoValidacion" style="appearance: auto">
              <option *ngFor="let option of tipoValidacionOpciones" value="{{option.value}}">{{option.label}} </option>
            </select>
          </div>

          <div class="field col-2">
            <label for="multivaluado">* ¿Multivaluado?</label>
            <select class="w-full  text-color surface-overlay" name="multivaluado" formControlName="multivaluado"
                    id="multivaluado" style="appearance: auto">
              <option *ngFor="let option of multivaluadoOpciones" value="{{option.value}}">{{option.label}} </option>
            </select>
          </div>

          <div class="field col-2">
            <label for="tipoDato">Tipo Dato</label>
            <select class="w-full  text-color surface-overlay" name="tipoDato" formControlName="tipoDato"
                    id="tipoDato" style="appearance: auto">
              <option *ngFor="let option of tipoDatoOpciones" value="{{option.value}}">{{option.label}} </option>
            </select>
          </div>

          <div class="field col-2">
            <label for="longitud">Longitud</label>
            <input id="longitud" class="inputfield w-full" type="text"
                   restriccionInputRegex
                   [regex]="ValidacionRegexEnum.NUMEROS"
                   [maxlength]="4"
                   pInputText autocomplete="off" name="longitud" formControlName="longitud">
          </div>

          <div class="field col-2">
            <label for="unidad">Unidad</label>
            <select [disabled]="this.formularioNuevoParametroComun.get('tipoDato')?.value !== 'NUM'"
                    class="w-full  text-color surface-overlay" name="unidad" formControlName="unidad" id="unidad"
                    style="appearance: auto">
              <option *ngFor="let option of unidadOpciones" value="{{option.value}}">{{option.label}} </option>
            </select>
          </div>


          <div class="field col-2">
            <label for="precision">Precisión</label>
            <input id="precision" class="inputfield w-full" type="text"
                   restriccionInputRegex
                   [regex]="ValidacionRegexEnum.NUMEROS"
                   [maxlength]="2"
                   pInputText autocomplete="off" name="precision" formControlName="precision"
                   [readOnly]="(this.formularioNuevoParametroComun.get('tipoDato')?.value !== 'NUM')">
          </div>


        </div>
      </div>
    </div>

  </form>

  <button pButton type="button" class="ml-2" (click)="crearNuevoParametroComun()"
          label="Nuevo Parametro Común"></button>

  <p class="campos-obligatorios text-left">Los campos marcados con asterisco (*) son obligatorios</p>
  <hr>


  <h4>Valores Parámetro</h4>

  <button pButton type="button" class="ml-2 mt-1" [disabled]="flagEnableAgregarNuevoParametro"
          label="Nuevo Valor Parámetro" (click)="agregarNuevoValorParametro()"></button>

  <p-table
    [rows]="10"
    [paginator]="true"
    [showCurrentPageReport]="true"
    selectionMode="single"
    [(selection)]="valorParametroSeleccionado"
    paginatorPosition="top"
    [lazy]="true"
    [pageLinks]="1"
    currentPageReportTemplate="Mostrando {first} de 0 registros "
    styleClass="p-datatable-sm p-datatable-gridlines" class="text-base">

    <ng-template pTemplate="header">
      <tr>
        <th>Descripción</th>
        <th>Valor</th>
        <th>Fecha Vigencia</th>
        <th>Valor Máximo</th>
        <th>Fecha Fin de Vigencia</th>
        <th>Estado</th>
        <th>Fecha Estado</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-vParametro>
      <tr [pSelectableRow]="vParametro">
        <td>{{ vParametro.descripcion }}</td>
        <td> {{ vParametro.valor }} </td>
        <td> {{ vParametro.fechaVigencia }} </td>
        <td> {{ vParametro.valorMaximo }} </td>
        <td> {{ vParametro.fechaFinVigencia }}</td>
        <td> {{ vParametro.estado }}</td>
        <td> {{ vParametro.fechaEstado}}</td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="7">No hay registros disponibles</td>
      </tr>
    </ng-template>

  </p-table>


</p-dialog>


<!-- MOSTRAR DETALLE VALOR PARAMETRO COMUN Y INGRESAR NUEVO VALOR PARAMATRO COMUN-->

<p-dialog [(visible)]="mostrarDetalleValoresParametroComun"
          [modal]="true"
          [style]="{width: '60%'}"
          [baseZIndex]="10000"
          [draggable]="false"
          [dismissableMask]="true">

  <ng-template pTemplate="header">
    <h2> Ingrese Nuevo Valor Parámetro </h2>
  </ng-template>

  <div class="card">

    <p class="text-sm">Parametro Común
      <span style="color: #669BCD; text-transform: uppercase; ">{{ parametroComunSeleccionado.descripcion }} </span></p>

    <!--
      this.valorParametroSeleccionado.estado === 'VIG' ||
                   this.valorParametroSeleccionado.estado === 'PPA') &&
    -->


    <div class="mt-2">
      <button pButton type="button" label="Nuevo Valor Parametro" class="ml-1"
              *ngIf="!flagViewNuevoValorParametro" name="botonAddNewValorParametro" id="botonAddNewValorParametro"
              [disabled]="( this.parametroComunSeleccionado.multivaluado !== 'Si') "
              (click)="agregarNuevoValorParametro()"></button>

      <button pButton type="button" label="Eliminar" class="ml-1"
              *ngIf="!flagViewEliminar"
              [disabled]="(this.valorParametroSeleccionado.estado !== 'RPA')"
              (click)="updateValorParametroPorEvento('ELIMINAR')"></button>

      <button pButton type="button" label="Inactivar" class="ml-1"
              *ngIf="!flagViewInactivar"
              [disabled]="this.valorParametroSeleccionado.estado !== 'VIG'"
              (click)="updateValorParametroPorEvento('INACTIVAR')"></button>


      <button pButton type="button" label="Activar" class="ml-1"
              *ngIf="!flagViewActivar"
              [disabled]="(this.valorParametroSeleccionado.estado !== 'INA') " (click)="updateValorParametroPorEvento('ACTIVAR')"></button>

      <button pButton type="button" label="Grabar" class="ml-1"
              *ngIf="!flagViewGrabar"
              (click)="editarOcrearValorParametro()"
              [disabled]="(flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'PPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'IPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'INA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'EPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'ELI')"></button>
    </div>

    <div class="card mt-2">
      <form class="formgrid" [formGroup]="formularioNuevoValorParametro">

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Descripción</label>
          <div class="col-12 md:col-10">
            <input id="descripcion" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="descripcion" formControlName="descripcion"
                   *ngIf="crearNuevoValorParametro else mostrarSoloTexto ">
          </div>
          <ng-template #mostrarSoloTexto>
            <span class="text-sm">{{  valorParametroSeleccionado.descripcion }}</span>
          </ng-template>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Valor</label>
          <div class="col-12 md:col-10">
            <input id="valor" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="valor" formControlName="valor">
          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Fecha Vigencia</label>
          <div class="col-12 md:col-3">
            <p-calendar [showIcon]="true" class="inputfield w-full" inputId="fecha" dateFormat="dd-mm-yy"
                        (onInput)="validarFechas($event, 'fechaVigencia')" formControlName="fechaVigencia"></p-calendar>
          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Valor Máximo</label>
          <div class="col-12 md:col-10">
            <input id="descripcion" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="valorMaximo" formControlName="valorMaximo">
          </div>
        </div>


        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Fecha Fin Vigencia</label>
          <div class="col-12 md:col-3">
            <p-calendar [showIcon]="true" class="inputfield w-full" inputId="fecha" dateFormat="dd-mm-yy"
                        (onInput)="validarFechas($event, 'fechaFinVigencia')" formControlName="fechaFinVigencia"></p-calendar>

          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Estado</label>
          <div class="col-12 md:col-3">
             <span class="text-sm" *ngIf=" crearNuevoValorParametro else mostrarSoloTextoEstado ">
              {{ getEstadoValorParametro(valorParametroSeleccionado.estado) }}
             </span>

            <ng-template #mostrarSoloTextoEstado>
              <span class="text-sm">{{ getEstadoValorParametro(valorParametroSeleccionado.estado) }}</span>
            </ng-template>

          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Fecha Estado</label>
          <div class="col-12 md:col-3">
            <span class="text-sm" *ngIf=" crearNuevoValorParametro else mostrarSoloTextoFechaEstado ">{{ fechaActual }}</span>
            <ng-template #mostrarSoloTextoFechaEstado>
              <span class="text-sm">{{  valorParametroSeleccionado.fechaEstado }}</span>
            </ng-template>
          </div>
        </div>

        <p class="campos-obligatorios text-left">Los campos marcados con asterisco (*) son obligatorios</p>
        <hr>

      </form>
    </div>


  </div>


</p-dialog>


<!--  CREAR NUEVO VALOR PARAMETRO  -->

<p-dialog [(visible)]="crearNuevoValorParametroComun"
          [modal]="true"
          [style]="{width: '60%'}"
          [baseZIndex]="10000"
          [draggable]="false"
          [dismissableMask]="true">

  <ng-template pTemplate="header">
    <h2> Ingrese Nuevo Valor Parámetro </h2>
  </ng-template>

  <div class="card">

    <p class="text-sm">Parametro Común
      <span style="color: #669BCD; text-transform: uppercase; ">{{ parametroComunSeleccionado.descripcion }} </span></p>

    <!--
      this.valorParametroSeleccionado.estado === 'VIG' ||
                   this.valorParametroSeleccionado.estado === 'PPA') &&
    -->


    <div class="mt-2">
      <button pButton type="button" label="Nuevo Valor Parametro" class="ml-1"
              *ngIf="!flagViewNuevoValorParametro" name="botonAddNewValorParametro" id="botonAddNewValorParametro"
              [disabled]="( this.parametroComunSeleccionado.multivaluado !== 'Si') "
              (click)="agregarNuevoValorParametro()"></button>

      <button pButton type="button" label="Eliminar" class="ml-1"
              *ngIf="!flagViewEliminar"
              [disabled]="true"
              (click)="updateValorParametroPorEvento('ELIMINAR')"></button>

      <button pButton type="button" label="Inactivar" class="ml-1"
              *ngIf="!flagViewInactivar"
              [disabled]="true"
              (click)="updateValorParametroPorEvento('INACTIVAR')"></button>


      <button pButton type="button" label="Activar" class="ml-1"
              *ngIf="!flagViewActivar"
              [disabled]="true" (click)="updateValorParametroPorEvento('ACTIVAR')"></button>

      <button pButton type="button" label="Grabar" class="ml-1"
              *ngIf="!flagViewGrabar"
              (click)="creacionValorParametro()"
              [disabled]="(flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'PPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'IPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'INA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'EPA') ||
              (flagEnableViewGrabar && this.valorParametroSeleccionado.estado == 'ELI')"></button>
    </div>

    <div class="card mt-2">
      <form class="formgrid" [formGroup]="formularioNuevoValorParametro">

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Descripción</label>
          <div class="col-12 md:col-10">
            <input id="descripcion" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="descripcion" formControlName="descripcion"
                   *ngIf="crearNuevoValorParametroComun else mostrarSoloTexto ">
          </div>
          <ng-template #mostrarSoloTexto>
            <span class="text-sm">{{  valorParametroSeleccionado.descripcion }}</span>
          </ng-template>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Valor</label>
          <div class="col-12 md:col-10">
            <input id="valor" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="valor" formControlName="valor">
          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">* Fecha Vigencia</label>
          <div class="col-12 md:col-3">
            <p-calendar [showIcon]="true" class="inputfield w-full" inputId="fecha" dateFormat="dd-mm-yy"
                        (onInput)="validarFechas($event, 'fechaVigencia')" formControlName="fechaVigencia"></p-calendar>
          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Valor Máximo</label>
          <div class="col-12 md:col-10">
            <input id="descripcion" class="inputfield w-full" type="text"
                   pInputText autocomplete="off" name="valorMaximo" formControlName="valorMaximo">
          </div>
        </div>


        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Fecha Fin Vigencia</label>
          <div class="col-12 md:col-3">
            <p-calendar [showIcon]="true" class="inputfield w-full" inputId="fecha" dateFormat="dd-mm-yy"
                        (onInput)="validarFechas($event, 'fechaFinVigencia')" formControlName="fechaFinVigencia"></p-calendar>

          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Estado</label>
          <div class="col-12 md:col-3">
             <span class="text-sm">
              {{cambioEstado}}
             </span>

          </div>
        </div>

        <div class="field grid">
          <label class="col-12 mb-2 md:col-2 md:mb-0">Fecha Estado</label>
          <div class="col-12 md:col-3">
            <span class="text-sm">{{ fechaActual }}</span>
          </div>
        </div>

        <p class="campos-obligatorios text-left">Los campos marcados con asterisco (*) son obligatorios</p>
        <hr>

      </form>
    </div>


  </div>


</p-dialog>
